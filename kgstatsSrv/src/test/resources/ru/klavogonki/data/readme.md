# Получение данных через CSV-файлы

Данные в формате CSV выгружены Переборычем запросами напрямую из базы Клавогонок в 2024 году.

Плюс такого подхода в том, что не нужно делать долгие и нестабильные запросы к API.

В идеале было бы использовать полный read-only дамп базы (можно скрывать поля вроде хэшей пароля, данных об оплате итд),
чтобы избегать промежуточных преобразований.

Но пока пробуем распарсить CSV и преобразовать в формат аналогичный тому, что мы получали из API-запросов.

Заметная разница по текущим данным — отсутствую джойны между таблицами, как для API.

Например, названия словарей находятся в отдельной таблице `vocs`, а в таблице `userinfo` есть только `id` словаря. 


:exclamation: Возможны проблемы с кодировкой в CSV-файлах — похоже, что они выгружены в кириллической кодировке
`Windows-1251`, а не в `UTF-8`.

# userinfo20240416.zip 

```sql
select * from klavogonki.userinfo where (num_races > 49);
```

Результаты юзеров по словарям. Названия словаря нет, оно находится в таблице `vocs`.

Выборка только для тех словарных результатов, где у игрока хотя бы 50 заездов. 

Это, в принципе, ок. Таким образом, количество записей будет разумным, не в несколько миллионов. 

## Поля

```csv
"id";"user_id";"mode";"texttype";"num_races";"avg_speed";"best_speed";"avg_error";"haul";"qual";"dirty";"updated"
```

Поля должны достаточно хорошо мапиться на результат API запроса, который описан классом  
`GetStatsOverviewGameTypeInfo` (генерируемым из OpenAPI спеки).

Но надо хорошо подумать и сравнить.

Метаданные словаря из `GetStatsOverviewGameType` находятся в таблице `vocs`. 

# vocs20241101.zip

```sql
select id, name from klavogonki.voc where (deleted = 0);
```

## Поля

Пока здесь только `id` и `name`, так что всех данных для `**GetStatsOverviewGameType**` нет.